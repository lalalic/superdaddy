language: node_js
node_js:
 - "4.2"
addons:
 apt:
  packages:
   - sshpass

install:
 - npm install --production
 - npm install browserify node-lessify uglifyify

script:
 - npm run merge
 - sshpass -e ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null $DEPLOY_USER@$DEPLOY_HOST mkdir -p $DEPLOY_PATH
 - sshpass -e scp -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null dist/allin1.html $DEPLOY_USER@$DEPLOY_HOST:$DEPLOY_PATH
 - npm run cordova
 - cd cordova
 - cordova platform add android
 - cordova build android
