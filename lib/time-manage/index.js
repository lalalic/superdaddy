"use strict";

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.TimeManage = exports.ACTION = exports.reducer = undefined;

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _react = require("react");

var _react2 = _interopRequireDefault(_react);

var _materialUi = require("material-ui");

var _colors = require("material-ui/styles/colors");

var _db = require("../db");

var _appBar = require("../components/app-bar");

var _appBar2 = _interopRequireDefault(_appBar);

var _core = require("./core");

var _core2 = _interopRequireDefault(_core);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var MyAppBar = function MyAppBar(props) {
	return _react2.default.createElement(_materialUi.AppBar, _extends({}, props, { style: { backgroundColor: _colors.cyan300 },
		iconElementLeft: _react2.default.createElement(
			_materialUi.FloatingActionButton,
			{
				mini: true,
				disabled: true,
				style: { fontSize: "xx-small", backgroundColor: _colors.cyan300 }
			},
			"\u6211"
		)
	}));
};

var BabyTimeManage = (0, _core2.default)(_appBar2.default, "baby");
var MyTimeManage = void 0;

var reducer = exports.reducer = function reducer(state, next) {
	var nextState = BabyTimeManage.reducer(state, next);
	if (nextState == state && MyTimeManage) nextState = MyTimeManage.reducer(state, next);
	return nextState;
};

var ACTION = exports.ACTION = {
	ADD: function ADD(knowledge) {
		return function (dispatch, getState) {
			var _id = knowledge._id,
			    title = knowledge.title,
			    score = knowledge.score;

			var task = { knowledge: _id, content: title, score: score };
			var ps = [];

			if (_db.Knowledge.isForBaby(knowledge)) ps.push(BabyTimeManage.ACTION.ADD(task)(dispatch, getState));

			if (_db.Knowledge.isForParent(knowledge) && MyTimeManage) ps.push(MyTimeManage.ACTION.ADD(task)(dispatch, getState));

			return Promise.all(ps);
		};
	},
	REMOVE: function REMOVE(knowledge) {
		return function (dispatch, getState) {
			var ps = [];
			if (_db.Knowledge.isForBaby(knowledge)) ps.push(BabyTimeManage.ACTION.REMOVE({ _id: knowledge._id })(dispatch, getState));

			if (_db.Knowledge.isForParent(knowledge) && MyTimeManage) ps.push(MyTimeManage.ACTION.REMOVE({ _id: knowledge._id })(dispatch, getState));

			return Promise.all(ps);
		};
	}
};

var TimeManage = exports.TimeManage = function TimeManage(_ref, _ref2) {
	var _id = _ref._id;
	var muiTheme = _ref2.muiTheme,
	    _ref2$minHeight = _ref2.minHeight,
	    minHeight = _ref2$minHeight === undefined ? (muiTheme.page.height - muiTheme.appBar.height - muiTheme.footbar.height) / 2 : _ref2$minHeight;
	return _react2.default.createElement(
		"div",
		null,
		_react2.default.createElement(
			"div",
			{ style: { minHeight: minHeight } },
			_react2.default.createElement(BabyTimeManage, null)
		),
		function () {
			if (!MyTimeManage) MyTimeManage = (0, _core2.default)(MyAppBar, _id);
			return _react2.default.createElement(MyTimeManage);
		}()
	);
};

TimeManage.contextTypes = {
	muiTheme: _react.PropTypes.object
};

exports.default = Object.assign(TimeManage, { reducer: reducer, ScorePad: BabyTimeManage.ScorePad });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90aW1lLW1hbmFnZS9pbmRleC5qcyJdLCJuYW1lcyI6WyJNeUFwcEJhciIsInByb3BzIiwiYmFja2dyb3VuZENvbG9yIiwiZm9udFNpemUiLCJCYWJ5VGltZU1hbmFnZSIsIk15VGltZU1hbmFnZSIsInJlZHVjZXIiLCJzdGF0ZSIsIm5leHQiLCJuZXh0U3RhdGUiLCJBQ1RJT04iLCJBREQiLCJkaXNwYXRjaCIsImdldFN0YXRlIiwiX2lkIiwia25vd2xlZGdlIiwidGl0bGUiLCJzY29yZSIsInRhc2siLCJjb250ZW50IiwicHMiLCJpc0ZvckJhYnkiLCJwdXNoIiwiaXNGb3JQYXJlbnQiLCJQcm9taXNlIiwiYWxsIiwiUkVNT1ZFIiwiVGltZU1hbmFnZSIsIm11aVRoZW1lIiwibWluSGVpZ2h0IiwicGFnZSIsImhlaWdodCIsImFwcEJhciIsImZvb3RiYXIiLCJjcmVhdGVFbGVtZW50IiwiY29udGV4dFR5cGVzIiwib2JqZWN0IiwiT2JqZWN0IiwiYXNzaWduIiwiU2NvcmVQYWQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOzs7O0FBRUE7O0FBQ0E7O0FBRUE7O0FBRUE7Ozs7QUFFQTs7Ozs7O0FBRUEsSUFBTUEsV0FBVSxTQUFWQSxRQUFVO0FBQUEsUUFDZiwrREFBWUMsS0FBWixJQUFtQixPQUFPLEVBQUNDLGdDQUFELEVBQTFCO0FBQ0MsbUJBQ0M7QUFBQTtBQUFBO0FBQ0MsVUFBTSxJQURQO0FBRUMsY0FBVSxJQUZYO0FBR0MsV0FBTyxFQUFDQyxVQUFTLFVBQVYsRUFBcUJELGdDQUFyQjtBQUhSO0FBQUE7QUFBQTtBQUZGLElBRGU7QUFBQSxDQUFoQjs7QUFjQSxJQUFNRSxpQkFBZSxzQ0FBNkIsTUFBN0IsQ0FBckI7QUFDQSxJQUFJQyxxQkFBSjs7QUFHTyxJQUFNQyw0QkFBUSxTQUFSQSxPQUFRLENBQUNDLEtBQUQsRUFBT0MsSUFBUCxFQUFjO0FBQ2xDLEtBQUlDLFlBQVVMLGVBQWVFLE9BQWYsQ0FBdUJDLEtBQXZCLEVB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RUFBekIsQyIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwge1Byb3BUeXBlc30gZnJvbSBcInJlYWN0XCJcclxuXHJcbmltcG9ydCB7QXBwQmFyLEZsb2F0aW5nQWN0aW9uQnV0dG9uLCBQYXBlcn0gZnJvbSBcIm1hdGVyaWFsLXVpXCJcclxuaW1wb3J0IHtjeWFuMzAwIGFzIGJnY30gZnJvbSBcIm1hdGVyaWFsLXVpL3N0eWxlcy9jb2xvcnNcIlxyXG5cclxuaW1wb3J0IHtLbm93bGVkZ2V9IGZyb20gXCIuLi9kYlwiXHJcblxyXG5pbXBvcnQgQmFieUFwcEJhciBmcm9tIFwiLi4vY29tcG9uZW50cy9hcHAtYmFyXCJcclxuXHJcbmltcG9ydCBUaW1lTWFuYWdlQ3JlYXRvciBmcm9tIFwiLi9jb3JlXCJcclxuXHJcbmNvbnN0IE15QXBwQmFyPShwcm9wcz0+KFxyXG5cdDxBcHBCYXIgey4uLnByb3BzfSBzdHlsZT17e2JhY2tncm91bmRDb2xvcjpiZ2N9fVxyXG5cdFx0aWNvbkVsZW1lbnRMZWZ0PXtcclxuXHRcdFx0PEZsb2F0aW5nQWN0aW9uQnV0dG9uXHJcblx0XHRcdFx0bWluaT17dHJ1ZX1cclxuXHRcdFx0XHRkaXNhYmxlZD17dHJ1ZX1cclxuXHRcdFx0XHRzdHlsZT17e2ZvbnRTaXplOlwieHgtc21hbGxcIixiYWNrZ3JvdW5kQ29sb3I6YmdjfX1cclxuXHRcdFx0XHQ+XHJcblx0XHRcdFx05oiRXHJcblx0XHRcdDwvRmxvYXRpbmdBY3Rpb25CdXR0b24+XHJcblx0XHR9XHJcblx0XHQvPlxyXG4pKVxyXG5cclxuY29uc3QgQmFieVRpbWVNYW5hZ2U9VGltZU1hbmFnZUNyZWF0b3IoQmFieUFwcEJhcixcImJhYnlcIilcclxubGV0IE15VGltZU1hbmFnZVxyXG5cclxuXHJcbmV4cG9ydCBjb25zdCByZWR1Y2VyPShzdGF0ZSxuZXh0KT0+e1xyXG5cdGxldCBuZXh0U3RhdGU9QmFieVRpbWVNYW5hZ2UucmVkdWNlcihzdGF0ZSxuZXh0KVxyXG5cdGlmKG5leHRTdGF0ZT09c3RhdGUgJiYgTXlUaW1lTWFuYWdlKVxyXG5cdFx0bmV4dFN0YXRlPU15VGltZU1hbmFnZS5yZWR1Y2VyKHN0YXRlLG5leHQpXHJcblx0cmV0dXJuIG5leHRTdGF0ZVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgQUNUSU9OPXtcclxuXHRBREQ6IGtub3dsZWRnZT0+KGRpc3BhdGNoLCBnZXRTdGF0ZSk9PntcclxuXHRcdGxldCB7X2lkLHRpdGxlLHNjb3JlfT1rbm93bGVkZ2VcclxuXHRcdGxldCB0YXNrPXtrbm93bGVkZ2U6X2lkLGNvbnRlbnQ6dGl0bGUsc2NvcmV9XHJcblx0XHRsZXQgcHM9W11cclxuXHRcdFxyXG5cdFx0aWYoS25vd2xlZGdlLmlzRm9yQmFieShrbm93bGVkZ2UpKVxyXG5cdFx0XHRwcy5wdXNoKEJhYnlUaW1lTWFuYWdlLkFDVElPTi5BREQodGFzaykoZGlzcGF0Y2gsIGdldFN0YXRlKSlcclxuXHRcdFxyXG5cdFx0aWYoS25vd2xlZGdlLmlzRm9yUGFyZW50KGtub3dsZWRnZSkgJiYgTXlUaW1lTWFuYWdlKVxyXG5cdFx0XHRwcy5wdXNoKE15VGltZU1hbmFnZS5BQ1RJT04uQUREKHRhc2spKGRpc3BhdGNoLCBnZXRTdGF0ZSkpXHJcblx0XHRcclxuXHRcdHJldHVybiBQcm9taXNlLmFsbChwcylcclxuXHR9LFxyXG5cdFJFTU9WRToga25vd2xlZGdlPT4oZGlzcGF0Y2gsIGdldFN0YXRlKT0+e1xyXG5cdFx0bGV0IHBzPVtdXHJcblx0XHRpZihLbm93bGVkZ2UuaXNGb3JCYWJ5KGtub3dsZWRnZSkpXHJcblx0XHRcdHBzLnB1c2goQmFieVRpbWVNYW5hZ2UuQUNUSU9OLlJFTU9WRSh7X2lkOmtub3dsZWRnZS5faWR9KShkaXNwYXRjaCwgZ2V0U3RhdGUpKVxyXG5cdFx0XHJcblx0XHRpZihLbm93bGVkZ2UuaXNGb3JQYXJlbnQoa25vd2xlZGdlKSAmJiBNeVRpbWVNYW5hZ2UpXHJcblx0XHRcdHBzLnB1c2goTXlUaW1lTWFuYWdlLkFDVElPTi5SRU1PVkUoe19pZDprbm93bGVkZ2UuX2lkfSkoZGlzcGF0Y2gsIGdldFN0YXRlKSlcclxuXHRcdFxyXG5cdFx0cmV0dXJuIFByb21pc2UuYWxsKHBzKVxyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IFRpbWVNYW5hZ2U9KHtfaWR9LHttdWlUaGVtZSwgbWluSGVpZ2h0PShtdWlUaGVtZS5wYWdlLmhlaWdodC1tdWlUaGVtZS5hcHBCYXIuaGVpZ2h0LW11aVRoZW1lLmZvb3RiYXIuaGVpZ2h0KS8yfSk9PihcclxuICAgIDxkaXY+XHJcblx0XHQ8ZGl2IHN0eWxlPXt7bWluSGVpZ2h0fX0+XHJcblx0XHRcdDxCYWJ5VGltZU1hbmFnZS8+XHJcblx0XHQ8L2Rpdj5cclxuXHRcdHtcclxuXHRcdFx0KGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0aWYoIU15VGltZU1hbmFnZSlcclxuXHRcdFx0XHRcdE15VGltZU1hbmFnZT1UaW1lTWFuYWdlQ3JlYXRvcihNeUFwcEJhcixfaWQpXHJcblx0XHRcdFx0cmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoTXlUaW1lTWFuYWdlKVxyXG5cdFx0XHR9KSgpXHJcblx0XHR9XHJcbiAgICA8L2Rpdj5cclxuKVxyXG5cclxuVGltZU1hbmFnZS5jb250ZXh0VHlwZXM9e1xyXG5cdG11aVRoZW1lOlByb3BUeXBlcy5vYmplY3RcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgT2JqZWN0LmFzc2lnbihUaW1lTWFuYWdlLHtyZWR1Y2VyLFNjb3JlUGFkOkJhYnlUaW1lTWFuYWdlLlNjb3JlUGFkfSlcclxuIl19